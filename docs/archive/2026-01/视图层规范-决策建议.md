# 视图层规范 - 决策建议

基于当前项目状态和最佳实践，给出以下建议。

---

## 决策建议总结

### 决策 1：组件目录命名风格
**建议：选项 A - PascalCase**

**理由：**
- ✅ 当前项目已使用 PascalCase（`WorkoutSet/`, `ExerciseGroup/`）
- ✅ 与组件名一致，更直观
- ✅ 符合 React 社区习惯
- ✅ 减少迁移成本

**实施：** 保持现状，统一使用 PascalCase

---

### 决策 2：组件组织方式
**建议：选项 A - 按功能组织（但保持页面特定组件在路由目录）**

**理由：**
- ✅ 当前项目结构：共享组件在 `components/`，页面特定组件在路由目录
- ✅ 这种混合方式对中小型项目很实用
- ✅ 页面特定组件放在路由目录更直观（与页面代码在一起）
- ✅ 共享组件集中管理，易于复用

**实施：**
- 共享组件：`components/` 目录
- 页面特定组件：保持在路由目录中（如 `app/workout/[date]/WorkoutSet/`）
- UI 组件：`components/ui/`（保持现状）

---

### 决策 3：路由目录单复数
**建议：选项 B - 保持现状（语义决定）**

**理由：**
- ✅ `workouts/` 表示"训练列表"页面，语义上使用复数合理
- ✅ 其他路由使用单数（`user/`, `exercise-library/`）也合理
- ✅ 修改成本高（需要改路由、所有引用、可能影响 SEO）
- ✅ RESTful API 中也有类似情况（`/users` vs `/user/:id`）

**实施：** 保持现状，但明确规则：
- 列表页面可以使用复数（`workouts/`）
- 详情页面使用单数（`workout/[date]/`）
- 资源页面使用单数（`user/`, `exercise-library/`）

---

### 决策 4：状态管理方案
**建议：选项 C - 混合方案**

**理由：**
- ✅ 当前使用 MobX（`authStore.js`）和 SWR（数据获取）
- ✅ 本地状态：`useState` / `useReducer`（React 内置）
- ✅ 共享状态：MobX（已在使用，保持）
- ✅ 服务器状态：SWR（已在使用，保持）
- ✅ 认证状态：NextAuth（已在使用，保持）

**实施：**
- 本地状态：`useState` / `useReducer`
- 共享业务状态：MobX（如 authStore）
- 服务器状态：SWR（数据获取）
- 认证状态：NextAuth session

**注意：** 如果 MobX 使用不多，可以考虑迁移到 Context API 或 Zustand（更轻量）

---

### 决策 5：类型文件位置
**建议：选项 A - `types/` 目录**

**理由：**
- ✅ 当前已有 `types/` 目录（`types/next-auth.d.ts`）
- ✅ 集中管理，易于查找
- ✅ 符合 TypeScript 项目常见实践
- ✅ 减少迁移成本

**实施：**
- 共享类型：`types/` 目录
- 组件特定类型：定义在组件文件中
- 领域类型：可以考虑放在 `domain/` 下（与后端 DDD 结构一致）

---

### 决策 6：自定义 Hooks 位置
**建议：选项 A - `hooks/` 目录**

**理由：**
- ✅ 当前有 `hooks/use-toast`（说明已有 hooks 目录）
- ✅ 集中管理，易于查找和复用
- ✅ 符合 React 社区习惯
- ✅ 避免在组件目录中散落

**实施：**
- 创建 `hooks/` 目录
- 所有自定义 Hooks 放在 `hooks/` 目录
- 命名：`useHookName.ts`

---

### 决策 7：样式方案
**建议：选项 A - Tailwind CSS（保持现状）**

**理由：**
- ✅ 当前使用 Tailwind CSS
- ✅ 开发效率高，无需写 CSS 文件
- ✅ 项目规模适中，Tailwind 足够
- ✅ 如果未来需要复杂样式，再考虑 CSS Modules

**实施：** 保持 Tailwind CSS，如果遇到复杂样式需求，再考虑引入 CSS Modules

---

### 决策 8：测试文件位置
**建议：选项 A - 与源文件同目录**

**理由：**
- ✅ 易于找到相关测试
- ✅ 符合 Next.js 和 React 社区习惯
- ✅ 文件关联更直观

**实施：**
- 测试文件：`ComponentName.test.tsx`（与源文件同目录）
- 测试工具：`tests/` 目录（如 `tests/setup/`）

---

### 决策 9：页面特定组件位置
**建议：选项 A - 放在路由目录中（保持现状）**

**理由：**
- ✅ 当前结构：页面特定组件在路由目录中
- ✅ 与页面代码在一起，易于理解上下文
- ✅ 减少迁移成本
- ✅ 对中小型项目很实用

**实施：** 保持现状
- 页面特定组件：`app/workout/[date]/WorkoutSet/`
- 共享组件：`components/`

---

### 决策 10：导入路径别名
**建议：选项 A - `@/`（保持现状）**

**理由：**
- ✅ 当前使用 `@/` 别名
- ✅ 符合 Next.js 约定
- ✅ 简洁明了
- ✅ 减少迁移成本

**实施：** 保持 `@/` 别名

---

## 最终决策记录

### 决策 1：组件目录命名
- [x] 选择 A：PascalCase
- [ ] 选择 B：kebab-case
- **决策结果：** PascalCase
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

### 决策 2：组件组织方式
- [x] 选择 A：按功能组织（混合：共享组件在 components/，页面特定组件在路由目录）
- [ ] 选择 B：按领域组织
- **决策结果：** 混合方案（共享组件集中，页面特定组件在路由目录）
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

### 决策 3：路由目录单复数
- [ ] 选择 A：统一使用单数
- [x] 选择 B：保持现状（语义决定）
- **决策结果：** 保持现状，列表页面可用复数，其他用单数
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

### 决策 4：状态管理方案
- [ ] 选择 A：Context API
- [ ] 选择 B：状态管理库
- [x] 选择 C：混合方案
- **决策结果：** 混合方案（本地状态用 useState，共享状态用 MobX，服务器状态用 SWR）
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

### 决策 5：类型文件位置
- [x] 选择 A：`types/` 目录
- [ ] 选择 B：`@types/` 目录
- [ ] 选择 C：按领域分散
- **决策结果：** `types/` 目录
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

### 决策 6：自定义 Hooks 位置
- [x] 选择 A：`hooks/` 目录
- [ ] 选择 B：组件同目录
- [ ] 选择 C：混合方案
- **决策结果：** `hooks/` 目录
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

### 决策 7：样式方案
- [x] 选择 A：Tailwind CSS（保持现状）
- [ ] 选择 B：CSS Modules
- [ ] 选择 C：混合方案
- **决策结果：** Tailwind CSS
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

### 决策 8：测试文件位置
- [x] 选择 A：与源文件同目录
- [ ] 选择 B：`__tests__/` 目录
- **决策结果：** 与源文件同目录
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

### 决策 9：页面特定组件位置
- [x] 选择 A：放在路由目录中（保持现状）
- [ ] 选择 B：放在 `components/` 目录
- **决策结果：** 放在路由目录中
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

### 决策 10：导入路径别名
- [x] 选择 A：`@/`（保持现状）
- [ ] 选择 B：更具体的别名
- **决策结果：** `@/`
- **决策日期：** 2025-01-01
- **决策人：** 项目团队

---

## 建议总结

### 核心原则
1. **保持现状为主**：减少迁移成本，优先修复明显问题
2. **实用主义**：选择适合项目规模的方案
3. **一致性**：在整个项目中保持一致的命名和组织方式

### 需要立即实施
1. ✅ 统一组件目录命名（PascalCase）
2. ✅ 创建 `hooks/` 目录并整理自定义 Hooks
3. ✅ 明确路由目录单复数规则

### 可以逐步改进
1. ⚠️ 考虑是否迁移 MobX 到更轻量的方案（如果使用不多）
2. ⚠️ 逐步迁移 `.jsx` → `.tsx`
3. ⚠️ 统一组件命名（修复拼写错误、小写组件名等）

---

**文档版本：** 1.0  
**创建日期：** 2025-01-01

